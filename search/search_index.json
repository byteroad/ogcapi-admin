{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"OGC API da DGT - Manual de Administra\u00e7\u00e3o Este manual destina-se a compreender e gerir a infraestrutura de dados OGCAPI da DGT, e o servidor onde ela se encontra instalada.","title":"In\u00edcio"},{"location":"#ogc-api-da-dgt-manual-de-administracao","text":"Este manual destina-se a compreender e gerir a infraestrutura de dados OGCAPI da DGT, e o servidor onde ela se encontra instalada.","title":"OGC API da DGT - Manual de Administra\u00e7\u00e3o"},{"location":"arquitectura/","text":"Arquitectura do Sistema A arquitectura do sistema, definida no ficheiro de configura\u00e7\u00e3o do docker compose , articula os v\u00e1rios servi\u00e7os que comp\u00f5em a IDE. No centro, est\u00e1 a pygeoapi , uma API de python que implementa v\u00e1rios Standards OGC API. Os servi\u00e7os podem ser divididos em v\u00e1rios grupos: Base de dados geospacial. Servi\u00e7os de Tiles. Servi\u00e7os de monitoriza\u00e7\u00e3o de logs. Servi\u00e7os que monitorizam outros servi\u00e7os. Os servi\u00e7os expostos \u00e0 Internet s\u00e3o publicados por um servidor de web ( apache ), que funciona como um proxy. \u00c9 tamb\u00e9m este servidor que faz a gest\u00e3o dos certificados SSL. Actualmente o servidor exp\u00f5e tr\u00eas sub-dom\u00ednios, que d\u00e3o acesso a tr\u00eas servi\u00e7os deste sistema: ogcapi.dgterritorio.gov.pt -> API com OGCAPI (pygeoapi). logs.dgterritorio.gov.pt -> monitoriza\u00e7\u00e3o de logs (matomo). logs.dgterritorio.gov.pt -> monitoriza\u00e7\u00e3o de servi\u00e7os (GeoHealthCheck). Mais detalhes sobre a configura\u00e7\u00e3o do apache podem ser encontrados neste ficheiro. Nos pr\u00f3ximos par\u00e1grafos, os servi\u00e7os s\u00e3o descritos com maior detalhe. Bases de dados geospacial A Base de Dados (BD) utilizada para guardar os dados geospaciais est\u00e1 no servi\u00e7o postgis . Na altura em que foi escrito este manual este servi\u00e7o tem um servidor PostgreSQL 15.0 com PostGIS 3.5.2. Quando o sistema inicia, um servi\u00e7o chamado db_and_api_init \u00e9 respons\u00e1vel por carregar os dados, em formatos diversos como Shapefile ou GeoPackage, na directoria \\data . Para al\u00e9m de pr\u00e9-processar e carregar esses dados, este servi\u00e7o tamb\u00e9m cria as vistas necess\u00e1rias na BD, e os ficheiros de configura\u00e7\u00e3o para a pygeoapi. Info Nem todas as colec\u00e7\u00f5es publicadas pela pygeoapi se encontram guardadas nesta BD. Este sistema usa tamb\u00e9m alguns dados que est\u00e3o guardados em BD externas (fora desta composi\u00e7\u00e3o e fora desta m\u00e1quina). Os endere\u00e7os desses servidores, assim como outros par\u00e2metros de conex\u00e3o s\u00e3o injectados no ficheiro de configura\u00e7\u00e3o da pygeoapi atrav\u00e9s de vari\u00e1veis ambientais. Essas vari\u00e1veis ambientais est\u00e3o descritas num ficheiro .env , que se encontra na raiz da directoria onde se encontra o ficheiro de docker compose. Servi\u00e7os de Tiles As tiles vectoriais s\u00e3o publicadas pela aplica\u00e7\u00e3o martin , que permite servir estes dados directamente a partir de tabelas de PostGIS. Para acelerar a performance, usaram-se Materialized Views no lugar de views, e criaram-se \u00edndices geospaciais e \u00edndices \u00fanicos para todas as vistas e tabelas. Como cada inst\u00e2ncia de martin fica assignada a uma BD, foram criadas tr\u00eas inst\u00e2ncias diferentes, assignadas a cada uma das BD usadas para guardar dados geospaciais: Servi\u00e7o tiles : publica tiles a partir de tabelas na base de dados geospacial . Servi\u00e7o tiles-inspire : publica tiles a partir de uma tabela com o cadastro, na BD inspire (externa). Servi\u00e7o tiles-caop : publica tiles a partir de tabelas na BD caop (externa). Warning O martin l\u00ea as tabelas da BD quando inicia. Por esse motivo, se forem adicionadas novas tabelas na BD, o martin n\u00e3o ir\u00e1 publicar-las at\u00e9 que o servidor seja reiniciado. Servi\u00e7os de Monitoriza\u00e7\u00e3o de Logs TODO Servi\u00e7os que Monitorizam outros Servi\u00e7os TODO","title":"Arquitectura do Sistema"},{"location":"arquitectura/#arquitectura-do-sistema","text":"A arquitectura do sistema, definida no ficheiro de configura\u00e7\u00e3o do docker compose , articula os v\u00e1rios servi\u00e7os que comp\u00f5em a IDE. No centro, est\u00e1 a pygeoapi , uma API de python que implementa v\u00e1rios Standards OGC API. Os servi\u00e7os podem ser divididos em v\u00e1rios grupos: Base de dados geospacial. Servi\u00e7os de Tiles. Servi\u00e7os de monitoriza\u00e7\u00e3o de logs. Servi\u00e7os que monitorizam outros servi\u00e7os. Os servi\u00e7os expostos \u00e0 Internet s\u00e3o publicados por um servidor de web ( apache ), que funciona como um proxy. \u00c9 tamb\u00e9m este servidor que faz a gest\u00e3o dos certificados SSL. Actualmente o servidor exp\u00f5e tr\u00eas sub-dom\u00ednios, que d\u00e3o acesso a tr\u00eas servi\u00e7os deste sistema: ogcapi.dgterritorio.gov.pt -> API com OGCAPI (pygeoapi). logs.dgterritorio.gov.pt -> monitoriza\u00e7\u00e3o de logs (matomo). logs.dgterritorio.gov.pt -> monitoriza\u00e7\u00e3o de servi\u00e7os (GeoHealthCheck). Mais detalhes sobre a configura\u00e7\u00e3o do apache podem ser encontrados neste ficheiro. Nos pr\u00f3ximos par\u00e1grafos, os servi\u00e7os s\u00e3o descritos com maior detalhe.","title":"Arquitectura do Sistema"},{"location":"arquitectura/#bases-de-dados-geospacial","text":"A Base de Dados (BD) utilizada para guardar os dados geospaciais est\u00e1 no servi\u00e7o postgis . Na altura em que foi escrito este manual este servi\u00e7o tem um servidor PostgreSQL 15.0 com PostGIS 3.5.2. Quando o sistema inicia, um servi\u00e7o chamado db_and_api_init \u00e9 respons\u00e1vel por carregar os dados, em formatos diversos como Shapefile ou GeoPackage, na directoria \\data . Para al\u00e9m de pr\u00e9-processar e carregar esses dados, este servi\u00e7o tamb\u00e9m cria as vistas necess\u00e1rias na BD, e os ficheiros de configura\u00e7\u00e3o para a pygeoapi. Info Nem todas as colec\u00e7\u00f5es publicadas pela pygeoapi se encontram guardadas nesta BD. Este sistema usa tamb\u00e9m alguns dados que est\u00e3o guardados em BD externas (fora desta composi\u00e7\u00e3o e fora desta m\u00e1quina). Os endere\u00e7os desses servidores, assim como outros par\u00e2metros de conex\u00e3o s\u00e3o injectados no ficheiro de configura\u00e7\u00e3o da pygeoapi atrav\u00e9s de vari\u00e1veis ambientais. Essas vari\u00e1veis ambientais est\u00e3o descritas num ficheiro .env , que se encontra na raiz da directoria onde se encontra o ficheiro de docker compose.","title":"Bases de dados geospacial"},{"location":"arquitectura/#servicos-de-tiles","text":"As tiles vectoriais s\u00e3o publicadas pela aplica\u00e7\u00e3o martin , que permite servir estes dados directamente a partir de tabelas de PostGIS. Para acelerar a performance, usaram-se Materialized Views no lugar de views, e criaram-se \u00edndices geospaciais e \u00edndices \u00fanicos para todas as vistas e tabelas. Como cada inst\u00e2ncia de martin fica assignada a uma BD, foram criadas tr\u00eas inst\u00e2ncias diferentes, assignadas a cada uma das BD usadas para guardar dados geospaciais: Servi\u00e7o tiles : publica tiles a partir de tabelas na base de dados geospacial . Servi\u00e7o tiles-inspire : publica tiles a partir de uma tabela com o cadastro, na BD inspire (externa). Servi\u00e7o tiles-caop : publica tiles a partir de tabelas na BD caop (externa). Warning O martin l\u00ea as tabelas da BD quando inicia. Por esse motivo, se forem adicionadas novas tabelas na BD, o martin n\u00e3o ir\u00e1 publicar-las at\u00e9 que o servidor seja reiniciado.","title":"Servi\u00e7os de Tiles"},{"location":"arquitectura/#servicos-de-monitorizacao-de-logs","text":"TODO","title":"Servi\u00e7os de Monitoriza\u00e7\u00e3o de Logs"},{"location":"arquitectura/#servicos-que-monitorizam-outros-servicos","text":"TODO","title":"Servi\u00e7os que Monitorizam outros Servi\u00e7os"},{"location":"logs/","text":"Titulo","title":"Monitoriza\u00e7\u00e3o de Logs"},{"location":"logs/#titulo","text":"","title":"Titulo"},{"location":"migracao/","text":"Titulo Instalacao do sistema","title":"Migra\u00e7\u00e3o para outro Servidor"},{"location":"migracao/#titulo","text":"Instalacao do sistema","title":"Titulo"},{"location":"recursos/","text":"Titulo","title":"Refer\u00eancias e Recursos de Aprendizagem"},{"location":"recursos/#titulo","text":"","title":"Titulo"},{"location":"resolucao/","text":"Titulo Interdependencias com outros sistemas Restart to servidor de tiles","title":"Resolu\u00e7\u00e3o de Problemas"},{"location":"resolucao/#titulo","text":"Interdependencias com outros sistemas Restart to servidor de tiles","title":"Titulo"},{"location":"servicos/","text":"Titulo","title":"Monitoriza\u00e7\u00e3o de Servi\u00e7os"},{"location":"servicos/#titulo","text":"","title":"Titulo"},{"location":"tarefas/","text":"Titulo SSL restart","title":"Tarefas de Manuten\u00e7\u00e3o"},{"location":"tarefas/#titulo","text":"SSL restart","title":"Titulo"},{"location":"tecnologias/","text":"Tecnologias Este sistema foi desenvolvido com recurso a tecnologias de software livre e de c\u00f3digo aberto. O servidor \u00e9 uma m\u00e1quina de Linux, que \u00e0 data de escrita deste manual tem o Ubuntu 24.04.2 LTS (Noble) instalado. \u00c9 recomendado adoptar releases LTS (Long Term Support) pela sua estabilidade, e tamb\u00e9m porque t\u00eam um suporte mais longo do que as vers\u00f5es Standard. O servidor tem habilitado um servidor de SSH (Secure shell) , que permite aceder de forma segura ao terminal e efectuar todas as opera\u00e7\u00f5es descritas neste manual. A Infra Estrutura de Dados (IDE) OGC API da DGT, de aqui em diante designada OGCAPI - DGT, est\u00e1 implementada utilizando m\u00e1quinas virtuais (docker containers), que s\u00e3o orquestradas usando docker compose. Docker \u00e9 uma plataforma para desenvolver, empacotar e correr aplica\u00e7\u00f5es. O Docker permite descrever a \"infraestrutura como c\u00f3digo\", e desta forma assegurar a reproducibilidade do sistema. Isso permite abstrair de uma infraestrutura espec\u00edfica, possibilitando a instala\u00e7\u00e3o em servidores de cloud ou nativos de diferentes provedores. O docker compose \u00e9 uma ferramenta que permite gerir aplica\u00e7\u00f5es que envolvem v\u00e1rios containers de docker. Os servi\u00e7os, volumes e redes podem ser descritos num \u00fanico ficheiro de configura\u00e7\u00e3o, e todo o sistema pode ser iniciado, reiniciado ou terminado com comandos simples. No pr\u00f3ximo cap\u00edtulo \u00e9 descrita a arquitectura da IDE, que est\u00e1 definida nos ficheiros de configura\u00e7\u00e3o do docker compose.","title":"Tecnologias Utilizadas"},{"location":"tecnologias/#tecnologias","text":"Este sistema foi desenvolvido com recurso a tecnologias de software livre e de c\u00f3digo aberto. O servidor \u00e9 uma m\u00e1quina de Linux, que \u00e0 data de escrita deste manual tem o Ubuntu 24.04.2 LTS (Noble) instalado. \u00c9 recomendado adoptar releases LTS (Long Term Support) pela sua estabilidade, e tamb\u00e9m porque t\u00eam um suporte mais longo do que as vers\u00f5es Standard. O servidor tem habilitado um servidor de SSH (Secure shell) , que permite aceder de forma segura ao terminal e efectuar todas as opera\u00e7\u00f5es descritas neste manual. A Infra Estrutura de Dados (IDE) OGC API da DGT, de aqui em diante designada OGCAPI - DGT, est\u00e1 implementada utilizando m\u00e1quinas virtuais (docker containers), que s\u00e3o orquestradas usando docker compose. Docker \u00e9 uma plataforma para desenvolver, empacotar e correr aplica\u00e7\u00f5es. O Docker permite descrever a \"infraestrutura como c\u00f3digo\", e desta forma assegurar a reproducibilidade do sistema. Isso permite abstrair de uma infraestrutura espec\u00edfica, possibilitando a instala\u00e7\u00e3o em servidores de cloud ou nativos de diferentes provedores. O docker compose \u00e9 uma ferramenta que permite gerir aplica\u00e7\u00f5es que envolvem v\u00e1rios containers de docker. Os servi\u00e7os, volumes e redes podem ser descritos num \u00fanico ficheiro de configura\u00e7\u00e3o, e todo o sistema pode ser iniciado, reiniciado ou terminado com comandos simples. No pr\u00f3ximo cap\u00edtulo \u00e9 descrita a arquitectura da IDE, que est\u00e1 definida nos ficheiros de configura\u00e7\u00e3o do docker compose.","title":"Tecnologias"}]}